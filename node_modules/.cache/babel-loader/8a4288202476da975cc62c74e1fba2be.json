{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\Project\\\\ReactJS\\\\Chatbot\\\\src\\\\components\\\\Search.js\";\nimport React, { Component } from 'react';\nimport { Loading } from 'react-simple-chatbot';\nimport { keyword_grade, keyword_major } from '../dummy/data.json';\nimport { bc, bc_topic, dpr, dpr_topic, topic } from '../dummy/data.json';\nimport \"../styles/accordion.css\";\nimport { v4 as uuidv4 } from 'uuid';\nexport default class Search extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      trigger: false,\n      level: null,\n      subject: null,\n      result: [],\n      results: [],\n      topicFound: []\n    };\n    this.triggerNext = this.triggerNext.bind(this);\n  }\n\n  async componentWillMount() {\n    const {\n      steps\n    } = this.props;\n    const {\n      search\n    } = steps;\n    const values = search.value.trim().toLowerCase().split(/[\\s,]+/);\n    let grade = [];\n    let major = [];\n    keyword_grade.map(child_grade => {\n      if (search.value.trim().toLowerCase().includes(child_grade.keyword.trim().toLowerCase())) grade = [child_grade];\n    });\n    keyword_major.map(child_major => {\n      if (search.value.trim().toLowerCase().includes(child_major.keyword.trim().toLowerCase())) major = [child_major];\n    });\n    values.map(value => {\n      keyword_grade.map(child_grade => {\n        if (child_grade.keyword.trim().toLowerCase() === value) grade = [child_grade];\n      });\n      keyword_major.map(child_major => {\n        if (child_major.keyword.trim().toLowerCase() === value) major = [child_major];\n      });\n    });\n    const includes = await Promise.all([(await Promise.all(bc.map(child_bc => {\n      if (child_bc.name.toLocaleLowerCase() == search.value.trim().toLowerCase()) {\n        return {\n          id: child_bc.id,\n          name: child_bc.name,\n          image: child_bc.image,\n          link: child_bc.link\n        };\n      } else {\n        let splitTopic = null;\n        const checkType = values.filter(value => value == 'dpr');\n\n        if (checkType.length > 0) {\n          return false;\n        }\n\n        values.map(value => {\n          child_bc.name.trim().toLowerCase().split(/[\\s,]+/).map(topic_word => {\n            if (!['bc', 'dpr'].includes(topic_word) && topic_word == value) {\n              splitTopic = {\n                id: child_bc.id,\n                name: child_bc.name,\n                image: child_bc.image,\n                link: child_bc.link\n              };\n            }\n          });\n        });\n        return splitTopic || false;\n      }\n    }))).filter(bc => bc), (await Promise.all(dpr.map(child_dpr => {\n      if (child_dpr.name.toLocaleLowerCase() == search.value.trim().toLowerCase()) {\n        return {\n          id: child_dpr.id,\n          name: child_dpr.name,\n          image: child_dpr.image,\n          link: child_dpr.link\n        };\n      } else {\n        let splitTopic = null;\n        const checkType = values.filter(value => value == 'bc');\n\n        if (checkType.length > 0) {\n          return false;\n        }\n\n        values.map(value => {\n          child_dpr.name.trim().toLowerCase().split(/[\\s,]+/).map(topic_word => {\n            if (!['bc', 'dpr'].includes(topic_word) && topic_word == value) {\n              splitTopic = {\n                id: child_dpr.id,\n                name: child_dpr.name,\n                image: child_dpr.image,\n                link: child_dpr.link\n              };\n            }\n          });\n        });\n        return splitTopic || false;\n      }\n    }))).filter(dpr => dpr), (await Promise.all(topic.map(topic => {\n      let results = [];\n\n      if (topic.name.toLowerCase().includes(search.value.toLowerCase()) || search.value.toLowerCase().includes(topic.name.toLowerCase())) {\n        const dprTopics = dpr_topic.filter(dpr => dpr.topic_id == topic.id);\n        const bcTopics = bc_topic.filter(bc => bc.topic_id == topic.id);\n        dprTopics.map(dprTopic => {\n          dpr.map(child_dpr => {\n            if (child_dpr.id == dprTopic.id) {\n              results = [...results, {\n                topic: topic.name,\n                name: child_dpr.name,\n                image: child_dpr.image,\n                link: child_dpr.link\n              }];\n            }\n          });\n        });\n        bcTopics.map(bcTopic => {\n          bc.map(child_bc => {\n            if (child_bc.id == bcTopic.id) {\n              results = [...results, {\n                topic: topic.name,\n                name: child_bc.name,\n                image: child_bc.image,\n                link: child_bc.link\n              }];\n            }\n          });\n        });\n      }\n\n      return results.length > 0 ? results : false;\n    }))).filter(topic => topic)]);\n    const level = grade.length > 0 ? [grade[0]] : [];\n    const subject = major.length > 0 ? [major[0]] : [];\n    const result = grade.length > 0 ? [grade[0]] : major.length > 0 ? [major[0]] : [];\n    const multi = level.length > 0 && subject.length > 0;\n    const topicFound = await Promise.all([includes[0].map(row => {\n      const filter = bc_topic.filter(bc => bc.bc_id == row.id);\n      const category = filter.length > 0 ? topic.filter(topic => topic.id == filter[0].topic_id) : false;\n      return {\n        name: row.name,\n        image: row.image,\n        link: row.link,\n        topic: category ? category.length > 0 ? category[0].name : null : null\n      };\n    }), includes[1].map(row => {\n      const filter = dpr_topic.filter(dpr => dpr.dpr_id == row.id);\n      const category = filter.length > 0 ? topic.filter(topic => topic.id == filter[0].topic_id) : false;\n      return {\n        name: row.name,\n        image: row.image,\n        link: row.link,\n        topic: category ? category.length > 0 ? category[0].name : null : null\n      };\n    }), ...includes[2]]);\n\n    if (multi) {\n      const results = await Promise.all([(await Promise.all(bc.map(row => {\n        try {\n          if (row.grade_id == level[0].grade_id && row.major_id == subject[0].major_id) {\n            const filter = bc_topic.filter(bc => bc.id == row.id);\n            const category = filter.length > 0 ? topic.filter(topic => topic.id == filter[0].topic_id) : false;\n            return {\n              name: row.name,\n              image: row.image,\n              link: row.link,\n              topic: category ? category.length > 0 ? category[0].name : null : null\n            };\n          }\n\n          return false;\n        } catch (error) {\n          return false;\n        }\n      }))).filter(bc => bc), (await Promise.all(dpr.map(row => {\n        try {\n          if (row.grade_id == level[0].grade_id && row.major_id == subject[0].major_id) {\n            const filter = dpr_topic.filter(dpr => dpr.id == row.id);\n            const category = filter.length > 0 ? topic.filter(topic => topic.id == filter[0].topic_id) : false;\n            return {\n              name: row.name,\n              image: row.image,\n              link: row.link,\n              topic: category ? category.length > 0 ? category[0].name : null : null\n            };\n          }\n\n          return false;\n        } catch (error) {\n          return false;\n        }\n      }))).filter(dpr => dpr)]);\n      this.setState({\n        results\n      });\n    }\n\n    this.setState({\n      trigger: 'subject_res',\n      level,\n      subject,\n      topicFound,\n      result,\n      loading: false\n    });\n\n    if (this.state.result.length < 1) {\n      this.props.triggerNextStep({\n        trigger: 're_search'\n      });\n    } else {\n      if (multi) {\n        this.props.triggerNextStep({\n          trigger: 're_search'\n        });\n      } else {\n        if (topicFound[0].length > 0 || topicFound[1].length > 0 || topicFound.length > 2) {\n          this.props.triggerNextStep({\n            trigger: 're_search'\n          });\n        } else {\n          if (level.length > 0) {\n            this.props.triggerNextStep({\n              trigger: 'search_subject'\n            });\n          } else if (subject.length > 0) {\n            this.props.triggerNextStep({\n              trigger: 'search_level'\n            });\n          }\n        }\n      }\n    }\n  }\n\n  triggerNext() {\n    this.setState({\n      trigger: true\n    }, () => {\n      this.props.triggerNextStep();\n    });\n  }\n\n  render() {\n    const {\n      loading,\n      result,\n      results,\n      topicFound\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: '100%'\n      },\n      children: loading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 29\n      }, this) : topicFound[0].length > 0 || topicFound[1].length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {},\n        children: topicFound.map((bcdpr, parentI) => {\n          if (parentI == 0 || parentI == 1) {\n            return bcdpr.map((row, i) => {\n              const uuid = uuidv4();\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  paddingTop: 12\n                },\n                children: /*#__PURE__*/_jsxDEV(\"nav\", {\n                  className: \"accordion arrows\",\n                  style: {},\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"radio\",\n                    name: \"accordion\",\n                    id: `bcdpr-${parentI}-${i + 1}-${uuid}`\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 225,\n                    columnNumber: 31\n                  }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n                    className: \"box\",\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      className: \"box-title\",\n                      htmlFor: `bcdpr-${parentI}-${i + 1}-${uuid}`,\n                      children: row.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 231,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                      className: \"box-close\",\n                      htmlFor: \"acc-close\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 237,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"box-content\",\n                      children: [/*#__PURE__*/_jsxDEV(\"small\", {\n                        children: row.topic\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 242,\n                        columnNumber: 35\n                      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n                        src: `/${row.image}`,\n                        alt: \"img\",\n                        style: {\n                          width: \"100%\",\n                          height: \"100%\",\n                          borderRadius: \"10px\"\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 243,\n                        columnNumber: 35\n                      }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                        children: /*#__PURE__*/_jsxDEV(\"a\", {\n                          href: row.link,\n                          className: \"link btn\",\n                          children: \"Lihat lebih banyak\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 248,\n                          columnNumber: 42\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 248,\n                        columnNumber: 35\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 241,\n                      columnNumber: 31\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 230,\n                    columnNumber: 31\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"radio\",\n                    name: \"accordion\",\n                    id: \"acc-close\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 251,\n                    columnNumber: 31\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 224,\n                  columnNumber: 27\n                }, this)\n              }, i + 1, false, {\n                fileName: _jsxFileName,\n                lineNumber: 223,\n                columnNumber: 27\n              }, this);\n            });\n          }\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 21\n      }, this) : topicFound.length > 2 && topicFound[2].length > 0 ? topicFound[2].map((row, i) => {\n        const uuid = uuidv4();\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            paddingTop: 12\n          },\n          children: /*#__PURE__*/_jsxDEV(\"nav\", {\n            className: \"accordion arrows\",\n            style: {},\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              name: \"accordion\",\n              id: `bcdpr-${i + 1}-${uuid}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n              className: \"box\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"box-title\",\n                htmlFor: `bcdpr-${i + 1}-${uuid}`,\n                children: row.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"box-close\",\n                htmlFor: \"acc-close\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 276,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"box-content\",\n                children: [/*#__PURE__*/_jsxDEV(\"small\", {\n                  children: row.topic\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 278,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: `/${row.image}`,\n                  alt: \"img\",\n                  style: {\n                    width: \"100%\",\n                    height: \"100%\",\n                    borderRadius: \"10px\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 279,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                  children: /*#__PURE__*/_jsxDEV(\"a\", {\n                    href: row.link,\n                    className: \"link btn\",\n                    children: \"Lihat lebih banyak\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 284,\n                    columnNumber: 42\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 284,\n                  columnNumber: 35\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              name: \"accordion\",\n              id: \"acc-close\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 29\n          }, this)\n        }, i + 1, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 25\n        }, this);\n      }) : results.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {},\n        children: results.map((bcdpr, parentI) => {\n          return bcdpr.map((row, i) => {\n            const uuid = uuidv4();\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                paddingTop: 12\n              },\n              children: /*#__PURE__*/_jsxDEV(\"nav\", {\n                className: \"accordion arrows\",\n                style: {},\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  name: \"accordion\",\n                  id: `bcdpr-${parentI}-${i + 1}-${uuid}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 299,\n                  columnNumber: 35\n                }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n                  className: \"box\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"box-title\",\n                    htmlFor: `bcdpr-${parentI}-${i + 1}-${uuid}`,\n                    children: row.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 305,\n                    columnNumber: 35\n                  }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"box-close\",\n                    htmlFor: \"acc-close\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 311,\n                    columnNumber: 35\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"box-content\",\n                    children: [/*#__PURE__*/_jsxDEV(\"small\", {\n                      children: row.topic\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 316,\n                      columnNumber: 39\n                    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n                      src: `/${row.image}`,\n                      alt: \"img\",\n                      style: {\n                        width: \"100%\",\n                        height: \"100%\",\n                        borderRadius: \"10px\"\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 317,\n                      columnNumber: 39\n                    }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                      children: /*#__PURE__*/_jsxDEV(\"a\", {\n                        href: row.link,\n                        className: \"link btn\",\n                        children: \"Lihat lebih banyak\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 322,\n                        columnNumber: 46\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 322,\n                      columnNumber: 39\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 315,\n                    columnNumber: 35\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 304,\n                  columnNumber: 35\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  name: \"accordion\",\n                  id: \"acc-close\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 325,\n                  columnNumber: 35\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 31\n              }, this)\n            }, i + 1, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 31\n            }, this);\n          });\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 22\n      }, this) : result.length > 0 ? `${result[0].keyword} ditemukan, tambahkan kata kunci lainnya` : 'Mejakitabot tidak dapat menemukan apa yang kamu cari'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["D:/Project/ReactJS/Chatbot/src/components/Search.js"],"names":["React","Component","Loading","keyword_grade","keyword_major","bc","bc_topic","dpr","dpr_topic","topic","v4","uuidv4","Search","constructor","props","state","loading","trigger","level","subject","result","results","topicFound","triggerNext","bind","componentWillMount","steps","search","values","value","trim","toLowerCase","split","grade","major","map","child_grade","includes","keyword","child_major","Promise","all","child_bc","name","toLocaleLowerCase","id","image","link","splitTopic","checkType","filter","length","topic_word","child_dpr","dprTopics","topic_id","bcTopics","dprTopic","bcTopic","multi","row","bc_id","category","dpr_id","grade_id","major_id","error","setState","triggerNextStep","render","width","bcdpr","parentI","i","uuid","paddingTop","height","borderRadius"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Loading } from 'react-simple-chatbot';\nimport { keyword_grade, keyword_major } from '../dummy/data.json';\nimport { bc, bc_topic, dpr, dpr_topic, topic } from '../dummy/data.json';\nimport \"../styles/accordion.css\";\nimport { v4 as uuidv4 } from 'uuid';\n\nexport default class Search extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            loading: true,\n            trigger: false,\n            level: null,\n            subject: null,\n            result: [],\n            results: [],\n            topicFound: []\n        };\n\n        this.triggerNext = this.triggerNext.bind(this);\n    }\n\n    async componentWillMount() {\n        const { steps } = this.props;\n        const { search } = steps;\n        const values = search.value.trim().toLowerCase().split(/[\\s,]+/)\n\n        let grade = []\n        let major = []\n\n        keyword_grade.map(child_grade => {\n            if (search.value.trim().toLowerCase().includes(child_grade.keyword.trim().toLowerCase())) grade = [child_grade]\n        })\n        keyword_major.map(child_major => {\n            if (search.value.trim().toLowerCase().includes(child_major.keyword.trim().toLowerCase())) major = [child_major]\n        })\n\n        values.map(value => {\n            keyword_grade.map(child_grade => {\n                if (child_grade.keyword.trim().toLowerCase() === value) grade = [child_grade]\n            })\n            keyword_major.map(child_major => {\n                if (child_major.keyword.trim().toLowerCase() === value) major = [child_major]\n            })\n        })\n\n        const includes = await Promise.all([\n            (await Promise.all(bc.map(child_bc => {\n                if (child_bc.name.toLocaleLowerCase() == search.value.trim().toLowerCase()) {\n                    return { id: child_bc.id, name: child_bc.name, image: child_bc.image, link: child_bc.link }\n                } else {\n                    let splitTopic = null\n\n                    const checkType = values.filter(value => value == 'dpr')\n                    if (checkType.length > 0) {\n                        return false\n                    }\n\n                    values.map(value => {\n                        child_bc.name.trim().toLowerCase().split(/[\\s,]+/).map(topic_word => {\n                            if (!['bc', 'dpr'].includes(topic_word) && topic_word == value) {\n                                splitTopic = { id: child_bc.id, name: child_bc.name, image: child_bc.image, link: child_bc.link }\n                            }\n                        })\n                    })\n                    return splitTopic || false\n                }\n            }))).filter(bc => bc),\n            (await Promise.all(dpr.map(child_dpr => {\n                if (child_dpr.name.toLocaleLowerCase() == search.value.trim().toLowerCase()) {\n                    return { id: child_dpr.id, name: child_dpr.name, image: child_dpr.image, link: child_dpr.link }\n                } else {\n                    let splitTopic = null\n\n                    const checkType = values.filter(value => value == 'bc')\n                    if (checkType.length > 0) {\n                        return false\n                    }\n\n                    values.map(value => {\n                        child_dpr.name.trim().toLowerCase().split(/[\\s,]+/).map(topic_word => {\n                            if (!['bc', 'dpr'].includes(topic_word) && topic_word == value) {\n                                splitTopic = { id: child_dpr.id, name: child_dpr.name, image: child_dpr.image, link: child_dpr.link }\n                            }\n                        })\n                    })\n                    return splitTopic || false\n                }\n            }))).filter(dpr => dpr),\n            (await Promise.all(topic.map(topic => {\n                let results = []\n                if (topic.name.toLowerCase().includes(search.value.toLowerCase()) || search.value.toLowerCase().includes(topic.name.toLowerCase())) {\n                    const dprTopics = dpr_topic.filter(dpr => dpr.topic_id == topic.id)\n                    const bcTopics = bc_topic.filter(bc => bc.topic_id == topic.id)\n\n                    dprTopics.map(dprTopic => {\n                        dpr.map(child_dpr => {\n                            if (child_dpr.id == dprTopic.id) {\n                                results = [...results, { topic: topic.name, name: child_dpr.name, image: child_dpr.image, link: child_dpr.link }]\n                            }\n                        })\n                    })\n\n                    bcTopics.map(bcTopic => {\n                        bc.map(child_bc => {\n                            if (child_bc.id == bcTopic.id) {\n                                results = [...results, { topic: topic.name, name: child_bc.name, image: child_bc.image, link: child_bc.link }]\n                            }\n                        })\n                    })\n                }\n                return results.length > 0 ? results : false\n            }))).filter(topic => topic),\n        ])\n\n        const level = grade.length > 0 ? [grade[0]] : []\n        const subject = major.length > 0 ? [major[0]] : []\n        const result = grade.length > 0 ? [grade[0]] : (major.length > 0 ? [major[0]] : [])\n        const multi = level.length > 0 && subject.length > 0\n\n        const topicFound = await Promise.all([\n            includes[0].map(row => {\n                const filter = bc_topic.filter(bc => bc.bc_id == row.id)\n                const category = filter.length > 0 ? topic.filter((topic) => topic.id == filter[0].topic_id) : false\n                return {\n                    name: row.name,\n                    image: row.image,\n                    link: row.link,\n                    topic: category ? (category.length > 0 ? category[0].name : null) : null\n                }\n            }),\n            includes[1].map(row => {\n                const filter = dpr_topic.filter(dpr => dpr.dpr_id == row.id)\n                const category = filter.length > 0 ? topic.filter((topic) => topic.id == filter[0].topic_id) : false\n                return {\n                    name: row.name,\n                    image: row.image,\n                    link: row.link,\n                    topic: category ? (category.length > 0 ? category[0].name : null) : null\n                }\n            }),\n            ...includes[2]\n        ])\n\n        if (multi) {\n            const results = await Promise.all([\n                (await Promise.all(bc.map(row => {\n                    try {\n                        if (row.grade_id == level[0].grade_id && row.major_id == subject[0].major_id) {\n                            const filter = bc_topic.filter(bc => bc.id == row.id)\n                            const category = filter.length > 0 ? topic.filter((topic) => topic.id == filter[0].topic_id) : false\n                            return {\n                                name: row.name,\n                                image: row.image,\n                                link: row.link,\n                                topic: category ? (category.length > 0 ? category[0].name : null) : null\n                            }\n                        }\n                        return false\n                    } catch (error) {\n                        return false\n                    }\n                }))).filter(bc => bc),\n                (await Promise.all(dpr.map(row => {\n                    try {\n                        if (row.grade_id == level[0].grade_id && row.major_id == subject[0].major_id) {\n                            const filter = dpr_topic.filter(dpr => dpr.id == row.id)\n                            const category = filter.length > 0 ? topic.filter((topic) => topic.id == filter[0].topic_id) : false\n                            return {\n                                name: row.name,\n                                image: row.image,\n                                link: row.link,\n                                topic: category ? (category.length > 0 ? category[0].name : null) : null\n                            }\n                        }\n                        return false\n                    } catch (error) {\n                        return false\n                    }\n                }))).filter(dpr => dpr),\n            ])\n            this.setState({ results });\n        }\n        this.setState({ trigger: 'subject_res', level, subject, topicFound, result, loading: false });\n\n        if (this.state.result.length < 1) {\n            this.props.triggerNextStep({ trigger: 're_search' })\n        } else {\n            if (multi) {\n                this.props.triggerNextStep({ trigger: 're_search' });\n            } else {\n                if (topicFound[0].length > 0 || topicFound[1].length > 0 || topicFound.length > 2) {\n                    this.props.triggerNextStep({ trigger: 're_search' });\n                } else {\n                    if (level.length > 0) {\n                        this.props.triggerNextStep({ trigger: 'search_subject' })\n                    } else if (subject.length > 0) {\n                        this.props.triggerNextStep({ trigger: 'search_level' })\n                    }\n                }\n            }\n        }\n    }\n\n    triggerNext() {\n        this.setState({ trigger: true }, () => {\n            this.props.triggerNextStep();\n        });\n    }\n\n    render() {\n        const { loading, result, results, topicFound } = this.state;\n        return (\n            <div style={{ width: '100%' }}>\n                { loading ? <Loading /> : (topicFound[0].length > 0 || topicFound[1].length > 0 ? (\n                    <div style={{}}>\n                    {topicFound.map((bcdpr, parentI) => {\n                        if(parentI == 0 || parentI == 1) {\n                      return bcdpr.map((row, i) => {\n                          const uuid = uuidv4()\n                          return (\n                          <div key={i + 1} style={{ paddingTop: 12 }}>\n                          <nav className=\"accordion arrows\" style={{}}>\n                              <input\n                              type=\"radio\"\n                              name=\"accordion\"\n                              id={`bcdpr-${parentI}-${i + 1}-${uuid}`}\n                              />\n                              <section className=\"box\">\n                              <label\n                                  className=\"box-title\"\n                                  htmlFor={`bcdpr-${parentI}-${i + 1}-${uuid}`}\n                              >\n                                  {row.name}\n                              </label>\n                              <label\n                                  className=\"box-close\"\n                                  htmlFor=\"acc-close\"\n                              ></label>\n                              <div className=\"box-content\">\n                                  <small>{row.topic}</small>\n                                  <img\n                                  src={`/${row.image}`}\n                                  alt=\"img\"\n                                  style={{ width: \"100%\", height: \"100%\", borderRadius: \"10px\" }}\n                                  />\n                                  <small><a href={row.link} className='link btn'>Lihat lebih banyak</a></small>\n                              </div>\n                              </section>\n                              <input type=\"radio\" name=\"accordion\" id=\"acc-close\" />\n                          </nav>\n                          </div>\n                          )\n                      });\n                }})}\n                </div>\n                ) : (topicFound.length > 2 && topicFound[2].length > 0 ? (\n                    topicFound[2].map((row, i) => {\n                        const uuid = uuidv4()\n                        return (\n                        <div key={i + 1} style={{ paddingTop: 12 }}>\n                            <nav className=\"accordion arrows\" style={{}}>\n                                <input\n                                type=\"radio\"\n                                name=\"accordion\"    \n                                id={`bcdpr-${i + 1}-${uuid}`}\n                                />\n                                <section className=\"box\">\n                                <label\n                                    className=\"box-title\"\n                                    htmlFor={`bcdpr-${i + 1}-${uuid}`}\n                                >\n                                    {row.name}\n                                </label>\n                                <label className=\"box-close\" htmlFor=\"acc-close\"></label>\n                                <div className=\"box-content\">\n                                    <small>{row.topic}</small>\n                                    <img\n                                    src={`/${row.image}`}\n                                    alt=\"img\"\n                                    style={{ width: \"100%\", height: \"100%\", borderRadius: \"10px\" }}\n                                    />\n                                  <small><a href={row.link} className='link btn'>Lihat lebih banyak</a></small>\n                                </div>\n                                </section>\n                                <input type=\"radio\" name=\"accordion\" id=\"acc-close\" />\n                            </nav>\n                        </div>\n                     ) })\n                ) : (results.length > 0 ?\n                    (<div style={{}}>\n                        {results.map((bcdpr, parentI) => {\n                          return bcdpr.map((row, i) => {\n                              const uuid = uuidv4()\n                              return (\n                              <div key={i + 1} style={{ paddingTop: 12 }}>\n                              <nav className=\"accordion arrows\" style={{}}>\n                                  <input\n                                  type=\"radio\"\n                                  name=\"accordion\"\n                                  id={`bcdpr-${parentI}-${i + 1}-${uuid}`}\n                                  />\n                                  <section className=\"box\">\n                                  <label\n                                      className=\"box-title\"\n                                      htmlFor={`bcdpr-${parentI}-${i + 1}-${uuid}`}\n                                  >\n                                      {row.name}\n                                  </label>\n                                  <label\n                                      className=\"box-close\"\n                                      htmlFor=\"acc-close\"\n                                  ></label>\n                                  <div className=\"box-content\">\n                                      <small>{row.topic}</small>\n                                      <img\n                                      src={`/${row.image}`}\n                                      alt=\"img\"\n                                      style={{ width: \"100%\", height: \"100%\", borderRadius: \"10px\" }}\n                                      />\n                                      <small><a href={row.link} className='link btn'>Lihat lebih banyak</a></small>\n                                  </div>\n                                  </section>\n                                  <input type=\"radio\" name=\"accordion\" id=\"acc-close\" />\n                              </nav>\n                              </div>\n                              )\n                          });\n                          })}\n                    </div>) : (result.length > 0 ? `${result[0].keyword} ditemukan, tambahkan kata kunci lainnya` : 'Mejakitabot tidak dapat menemukan apa yang kamu cari'))))}\n            </div>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}